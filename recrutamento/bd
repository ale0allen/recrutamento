-- Criação das tabelas
CREATE TABLE IF NOT EXISTS role (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS app_user (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS app_user_roles (
    app_user_id BIGINT,
    roles_id BIGINT,
    PRIMARY KEY (app_user_id, roles_id),
    FOREIGN KEY (app_user_id) REFERENCES app_user(id),
    FOREIGN KEY (roles_id) REFERENCES role(id)
);

-- Inserir role
INSERT INTO role (name) VALUES ('ROLE_USER');

-- Inserir usuário com senha BCrypt
-- Lembre-se de substituir a senha hash com uma gerada especificamente para sua aplicação
INSERT INTO app_user (username, password) VALUES ('testuser', '$2a$10$DowJmPxA2IsjCjy8sOBF4OUtP95wLjDsFrGz98R45R9wWjIukisXa');

-- Associar usuário à role
-- Certifique-se de que os IDs sejam corretos conforme inserção
INSERT INTO app_user_roles (app_user_id, roles_id) VALUES ((SELECT id FROM app_user WHERE username='testuser'), (SELECT id FROM role WHERE name='ROLE_USER'));
